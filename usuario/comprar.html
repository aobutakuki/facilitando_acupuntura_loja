<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Facilitando Acupuntura</title>
   
    <link rel="icon" type="image/x-icon" href="../resources/images/logo.png">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../resources/css/comprar.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Additional Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  </head>
  <body>
    
    <div class="head_bar">
      <div class="container">
        <div class="row">
          <div class="col-2 d-flex align-items-center">
            <img src="../resources/images/logo.png" alt="Logo" width="25" height="25" class="me-2">
            <h5 class="mb-0">Facilitando Acupuntura</h5>
          </div>
          <div class="col-6"></div>
          <div class="col-sm-auto"><a href="./blog/index.html" class="nav-link">Blog</a></div>
          <div class="col-sm-auto"><a href="/sobre" class="nav-link">Sobre</a></div>
          <div class="col-sm-auto"><a href="../cursos/index.html" class="nav-link">Cursos</a></div>
          <div class="col-sm-auto"><a href="../usuario/carrinho.html" class="nav-link">Carrinho</a></div>
        </div>
      </div>
    </div>

    <div class="container main-container">
      <div class="row">
        <!-- Left Column - User Info -->
        <div class="col-md-6">
          <h3 class="section-title">Seus dados</h3>
          
          <div class="payment-card">
            <div class="form-group mb-3">
              <label for="user-name">Nome Completo</label>
              <input type="text" class="form-control" id="user-name" placeholder="Digite seu nome completo">
            </div>
            
            <div class="form-group mb-3">
              <label for="user-email">E-mail</label>
              <input type="email" class="form-control" id="user-email" placeholder="Digite seu e-mail">
            </div>
            
            <div class="form-group mb-3">
              <label for="user-cpf">CPF</label>
              <input type="text" class="form-control" id="user-cpf" placeholder="Digite seu CPF">
            </div>
            
            <div class="form-group">
              <label for="user-nationality">Nacionalidade</label>
              <input type="text" class="form-control" id="user-nationality" placeholder="Digite sua nacionalidade">
            </div>
          </div>
        </div>
        
        <!-- Right Column - Payment Info -->
        <div class="col-md-6">
          <h3 class="section-title">Resumo da compra</h3>
          
          <div class="payment-card">
            <div class="d-flex justify-content-between mb-2">
              <p>Curso 1: Introdução à Acupuntura</p>
              <p class="price">R$ 99,00</p>
            </div>
            
            <div class="d-flex justify-content-between mt-3 pt-2 border-top">
              <p class="total-price">Total:</p>
              <p class="total-price">R$ 99,00</p>
            </div>
          </div>
          
          <div class="payment-card">
            <h4 class="mb-3">Forma de pagamento</h4>
            
            <ul class="nav nav-tabs mb-3" id="paymentTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="credit-card-tab" data-bs-toggle="tab" data-bs-target="#credit-card-form" type="button" role="tab" aria-controls="credit-card" aria-selected="true">
                  Cartão de Crédito
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="pix-tab" data-bs-toggle="tab" data-bs-target="#pix-form" type="button" role="tab" aria-controls="pix" aria-selected="false">
                  PIX
                </button>
              </li>
            </ul>
            
            <div class="tab-content" id="paymentTabsContent">
              <div class="tab-pane fade show active" id="credit-card-form" role="tabpanel" aria-labelledby="credit-card-tab">
                <div class="form-group mb-3">
                  <label for="card-number">Número do Cartão</label>
                  <input type="text" class="form-control" id="card-number" placeholder="1234 5678 9012 3456">
                </div>
                
                <div class="form-group mb-3">
                  <label for="card-name">Nome no Cartão</label>
                  <input type="text" class="form-control" id="card-name" placeholder="Nome como está no cartão">
                </div>
                
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label for="card-expiry">Validade</label>
                      <input type="text" class="form-control" id="card-expiry" placeholder="MM/AA">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label for="card-cvv">CVV</label>
                      <input type="text" class="form-control" id="card-cvv" placeholder="123">
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="tab-pane fade" id="pix-form" role="tabpanel" aria-labelledby="pix-tab">
                <div class="pix-qr-container">
                  <p>Expira em: 10 minutos</p>
                  <div class="my-4">
                    <canvas id="pixQrCode" width="200" height="200"></canvas>
                  </div>
                  <p>Código PIX (copie e cole no seu app bancário):</p>
                  <div class="input-group mb-3">
                    <input type="text" id="pix-key" class="form-control" readonly>
                    <button class="btn btn-outline-secondary" type="button" onclick="copyPixCode()">Copiar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Buy Button Container -->
          <div class="buy-button-container">
            <button class="btn btn-buy" id="finalizar-compra">
              <a href="../usuario/receber.html" class="text-white text-decoration-none"> 
                <i class="fas fa-credit-card me-2"></i>Finalizar Compra
              </a>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initialize tabs and PIX generation
      document.addEventListener('DOMContentLoaded', function() {
        // Generate PIX when tab is shown
        const pixTab = document.getElementById('pix-tab');
        const pixTabInstance = new bootstrap.Tab(pixTab);
        
        pixTab.addEventListener('shown.bs.tab', function() {
          generateMockPix();
        });
      
        // Generate PIX immediately if tab is active on load
        if(pixTab.classList.contains('active')) {
          generateMockPix();
        }
      
        // Payment confirmation
        document.getElementById('finalizar-compra').addEventListener('click', function() {
          const activeTab = document.querySelector('#paymentTabs .nav-link.active');
          if(activeTab.id === 'pix-tab') {
            const modalHtml = `
              <div class="mock-payment-modal" style="
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); display: flex; justify-content: center;
                align-items: center; z-index: 1000;">
                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center;">
                  <h3>Pagamento com PIX</h3>
                  <p>Simulação de pagamento em andamento...</p>
                  <div style="margin: 20px 0;">
                    <img src="https://cdn-icons-png.flaticon.com/512/179/179386.png" width="100">
                  </div>
                  <button onclick="confirmMockPayment()" style="
                    background: #220A38; color: white; border: none; 
                    padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                    Confirmar Pagamento
                  </button>
                </div>
              </div>`;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
          } else {
            // Handle credit card payment
            alert('Pagamento com cartão confirmado com sucesso! Curso liberado.');
          }
        });
      });
      
      function generateMockPix() {
        const mockPixData = {
          courseName: "Curso 1: Introdução à Acupuntura",
          price: "R$ 99,00",
          merchant: "Facilitando Acupuntura",
          transactionId: "MOCK" + Math.random().toString(36).substr(2, 10).toUpperCase()
        };
      
        const mockPixCode = `00020126580014BR.GOV.BCB.PIX0136teste@facilitandoacupuntura.com52040000530398654${mockPixData.price.replace('R$ ', '')}5802BR5925${mockPixData.merchant}6015SAO PAULO62070503***6304`;
      
        const qr = new QRious({
          element: document.getElementById('pixQrCode'),
          value: mockPixCode,
          size: 200,
          background: '#f6f7f6',
          foreground: '#220A38'
        });
      
        document.getElementById('pix-key').value = mockPixCode;
       
      }
      
      function copyPixCode() {
        const pixCode = document.getElementById('pix-key');
        pixCode.select();
        document.execCommand('copy');
        
        const copyBtn = document.querySelector('.pix-qr-container button');
        copyBtn.textContent = 'Copiado!';
        copyBtn.classList.remove('btn-outline-secondary');
        copyBtn.classList.add('btn-success');
        setTimeout(() => {
          copyBtn.textContent = 'Copiar';
          copyBtn.classList.remove('btn-success');
          copyBtn.classList.add('btn-outline-secondary');
        }, 2000);
      }
      
      window.confirmMockPayment = function() {
        document.querySelector('.mock-payment-modal').remove();
        alert('Pagamento confirmado com sucesso! Curso liberado.');
      };
    </script>
  </body>
</html>